# test for parsing, making sure it matches with fetch

print("-------Test for parsing to make sure it is adaptable with fetch-------")
print("--------------------------10 records-----------------------------------")

print("")
from Bio import Entrez
from Bio import SeqIO


Entrez.email = "Felix.wae@gmail.com" #Always tell NCBI who you are
Entrez.api_key = "7b4a5e9841f79495be73767323ad485fda08" #Always use key

# Multiple Entre.efetch test. 10 records. 
accession_numbers = "NC_000913.3, NC_000964.3, NC_002516.2, NZ_CP041016.1, NZ_AP023438.1, NC_022737.1, NZ_CP013444.1, NZ_CP086979.1, NZ_CP085753.1, NZ_CP012026.1"
i = 0
with Entrez.efetch(
    db="nucleotide", rettype="gbwithparts", retmode="text", id=accession_numbers
) as handle:
    for seq_record in SeqIO.parse(handle, "gb"):
        i += 1
        print()
        print("Record number: ", i)
        print("%s %s..." % (seq_record.id, seq_record.description[:50]))
        print(
            "Sequence length %i, %i features, from: %s"
            % (
                len(seq_record),
                len(seq_record.features),
                seq_record.annotations["source"],
            )
        )

print("")
print("------------------Test done----------------")